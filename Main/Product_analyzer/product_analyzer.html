<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoAnalyzer - AI Biodegradable Product Segregator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8f8d5f4;
            transition: all 0.3s ease;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #2d5016, #317223 100%);
        }
        
        .result-card {
            transform: translateY(20px);
            opacity: 0;
            transition: transform 0.5s, opacity 0.5s;
        }
        
        .result-card.visible {
            transform: translateY(0);
            opacity: 1;
        }
        
        .upload-area {
            border: 2px dashed #cbd5e0;
            transition: all 0.3s ease;
        }
        
        .upload-area.active {
            border-color: #4FD1C5;
            background-color: rgba(79, 209, 197, 0.1);
        }
        
        .progress-bar {
            height: 6px;
            background-color: #e2e8f0;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #38B2AC;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .material-card {
            transform: scale(0.95);
            opacity: 0;
            transition: transform 0.3s, opacity 0.3s;
        }
        
        .material-card.visible {
            transform: scale(1);
            opacity: 1;
        }
        
        .eco-badge {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.8; }
            50% { opacity: 1; }
            100% { opacity: 0.8; }
        }
    </style>
</head>
<body class="min-h-screen">
    <div class="gradient-bg text-white py-12 px-4 text-center">
        <h1 class="text-4xl font-bold mb-4">EcoAnalyzer</h1>
        <p class="text-xl mb-6">AI-Powered Biodegradable Product Segregator</p>
        <p class="max-w-2xl mx-auto">Upload an image of any product to analyze its materials, environmental impact, and discover eco-friendly alternatives for a greener planet.</p>
    </div>

    <div class="max-w-4xl mx-auto px-4 py-12">
        <div id="upload-section" class="bg-white rounded-lg shadow-lg p-8 mb-12">
            <div class="text-center mb-8">
                <h2 class="text-2xl font-semibold text-gray-800 mb-2">Product Analysis</h2>
                <p class="text-gray-600">Upload a clear image of any product to analyze its biodegradable properties and environmental impact.</p>
            </div>
            
            <div id="upload-area" class="upload-area rounded-lg p-12 text-center cursor-pointer mb-6">
                <input type="file" id="file-input" class="hidden" accept="image/*">
                <div class="flex flex-col items-center justify-center">
                    <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/e4cfe1c3-93fc-464f-8e40-3a16a52a2137.png" alt="Upload icon with green arrow pointing upward into a cloud" class="mb-4">
                    <h3 class="text-lg font-medium text-gray-700 mb-2">Drag & drop your image here</h3>
                    <p class="text-gray-500 mb-4">or click to browse files</p>
                    <p class="text-sm text-gray-400">Supports JPG, PNG (Max 5MB)</p>
                </div>
            </div>
            
            <div id="progress-container" class="hidden mb-6">
                <div class="flex justify-between mb-2">
                    <span class="text-sm font-medium text-gray-700">Analyzing...</span>
                    <span id="progress-percent" class="text-sm text-gray-500">0%</span>
                </div>
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
            </div>
            
            <div id="sample-images" class="mt-8">
                <p class="text-gray-500 text-center mb-4">Or try one of these sample products:</p>
                <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
                    <div class="cursor-pointer sample-image" data-image="plastic-bottle">
                        <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/051eb190-05bc-41fa-83ff-4528da1e26b8.png" alt="Clear plastic water bottle with blue cap half full of water" class="rounded-lg w-full h-24 object-cover mb-2">
                        <p class="text-xs text-center text-gray-600">Plastic Bottle</p>
                    </div>
                    <div class="cursor-pointer sample-image" data-image="cardboard-box">
                        <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/74d9b4d7-353b-4ff1-99fc-23771d5b9e70.png" alt="Brown corrugated cardboard box with shipping label" class="rounded-lg w-full h-24 object-cover mb-2">
                        <p class="text-xs text-center text-gray-600">Cardboard Box</p>
                    </div>
                    <div class="cursor-pointer sample-image" data-image="metal-can">
                        <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/cedd6283-af19-4aec-aee7-12b1163ba846.png" alt="Shiny aluminum soda can with red and white branding" class="rounded-lg w-full h-24 object-cover mb-2">
                        <p class="text-xs text-center text-gray-600">Metal Can</p>
                    </div>
                    <div class="cursor-pointer sample-image" data-image="glass-jar">
                        <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/e9864c8a-4a25-4d7a-a146-0e836388ba9b.png" alt="Clear glass mason jar with metal lid containing homemade jam" class="rounded-lg w-full h-24 object-cover mb-2">
                        <p class="text-xs text-center text-gray-600">Glass Jar</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="results-section" class="hidden">
            <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                <div class="flex flex-col md:flex-row gap-6">
                    <div class="md:w-1/3">
                        <div class="bg-gray-100 rounded-lg p-4">
                            <img id="result-image" src="" alt="" class="rounded-lg w-full">
                        </div>
                    </div>
                    <div class="md:w-2/3">
                        <h2 class="text-2xl font-semibold text-gray-800 mb-4" id="product-name">Product Name</h2>
                        <div class="flex items-center mb-4">
                            <span class="text-lg font-medium mr-2">Material Composition:</span>
                            <span id="material-composition" class="px-3 py-1 rounded-full text-sm font-medium bg-amber-100 text-amber-800">Loading...</span>
                        </div>
                        
                        <div class="mt-2" id="material-breakdown">
                            <!-- Will be filled by JS -->
                        </div>
                        
                        <div class="flex items-center mt-4">
                            <span class="text-lg font-medium mr-2">Biodegradability:</span>
                            <span id="biodegradability" class="px-3 py-1 rounded-full text-sm font-medium bg-emerald-100 text-emerald-800">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="grid md:grid-cols-2 gap-6 mb-8">
                <div class="result-card bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                        <svg class="w-5 h-5 text-amber-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                        Materials Analysis
                    </h3>
                    <div id="materials-analysis" class="text-gray-700">
                        <p class="animate-pulse">Analyzing material composition and properties...</p>
                    </div>
                </div>
                
                <div class="result-card bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                        <svg class="w-5 h-5 text-red-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M5.636 5.636l3.536 3.536m0 5.656l-3.536 3.536"></path>
                        </svg>
                        Environmental Impact
                    </h3>
                    <div id="environmental-impact" class="text-gray-700">
                        <p class="animate-pulse">Calculating environmental footprint and decomposition time...</p>
                    </div>
                </div>
            </div>
            
            <div class="result-card bg-white rounded-lg shadow-lg p-6 mb-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                    <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    Eco-Friendly Alternatives
                </h3>
                <div id="eco-alternatives" class="text-gray-700">
                    <p class="animate-pulse">Researching sustainable alternatives and solutions...</p>
                </div>
                <div id="alternatives-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-4">
                    <!-- Will be filled by JS -->
                </div>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const uploadArea = document.getElementById('upload-area');
            const fileInput = document.getElementById('file-input');
            const progressContainer = document.getElementById('progress-container');
            const progressFill = document.getElementById('progress-fill');
            const progressPercent = document.getElementById('progress-percent');
            const uploadSection = document.getElementById('upload-section');
            const resultsSection = document.getElementById('results-section');
            const sampleImages = document.querySelectorAll('.sample-image');
            
            // --- Configuration for your backend ---
            const BACKEND_URL = 'http://localhost:3000'; // Must match your Node.js server port

            // Drag and drop functionality
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('active');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('active');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('active');
                if (e.dataTransfer.files.length) {
                    fileInput.files = e.dataTransfer.files;
                    handleFileUpload(fileInput.files[0]);
                }
            });
            
            uploadArea.addEventListener('click', () => {
                fileInput.click();
            });
            
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length) {
                    handleFileUpload(e.target.files[0]);
                }
            });
            
            // Sample images click handler
            sampleImages.forEach(img => {
                img.addEventListener('click', () => {
                    const imageType = img.getAttribute('data-image');
                    simulateAnalysisForSample(imageType);
                });
            });
            
            function handleFileUpload(file) {
                if (!file.type.match('image.*')) {
                    alert('Please upload an image file (JPG, PNG)');
                    return;
                }
                
                if (file.size > 5 * 1024 * 1024) {
                    alert('File size should be less than 5MB');
                    return;
                }
                
                // Show progress bar
                progressContainer.classList.remove('hidden');
                uploadSection.classList.add('opacity-50', 'pointer-events-none');
                
                // Simulate upload progress
                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 10;
                    if (progress >= 100) {
                        progress = 100;
                        clearInterval(interval);
                        processImage(file);
                    }
                    progressFill.style.width = `${progress}%`;
                    progressPercent.textContent = `${Math.round(progress)}%`;
                }, 200);
            }
            
            function processImage(file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    // Hide upload section and show results
                    setTimeout(() => {
                        uploadSection.classList.add('hidden');
                        resultsSection.classList.remove('hidden');
                        
                        // Set the uploaded image
                        const resultImage = document.getElementById('result-image');
                        resultImage.src = e.target.result;
                        
                        // Analyze the image (now calls backend)
                        analyzeProduct(e.target.result); // Pass Base64 string
                    }, 500);
                };
                reader.readAsDataURL(file); // Read file as Base64
            }
            
            function simulateAnalysisForSample(imageType) {
                progressContainer.classList.remove('hidden');
                uploadSection.classList.add('opacity-50', 'pointer-events-none');
                
                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 15;
                    if (progress >= 100) {
                        progress = 100;
                        clearInterval(interval);
                        
                        uploadSection.classList.add('hidden');
                        resultsSection.classList.remove('hidden');
                        
                        // Set sample image
                        const resultImage = document.getElementById('result-image');
                        const samples = {
                            'plastic-bottle': 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/76649354-154c-4f47-bc8c-a7dc0eece884.png',
                            'cardboard-box': 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/56a29fa4-dcce-44b9-af63-ddff14e3973b.png',
                            'metal-can': 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/e43cbcf8-64ea-4ead-8ce5-6121045c0e1d.png',
                            'glass-jar': 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/ef2d8559-fee2-4e81-bc09-9a476c41b7ac.png'
                        };
                        resultImage.src = samples[imageType];
                        resultImage.alt = imageType.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
                        
                        // For sample images, we still use the local sample data directly
                        analyzeProduct(null, imageType); 
                    }
                    progressFill.style.width = `${progress}%`;
                    progressPercent.textContent = `${Math.round(progress)}%`;
                }, 150);
            }
            
            // --- MODIFIED: analyzeProduct to call backend ---
            async function analyzeProduct(imageData, sampleType = null) {
                let analysisData;
                
                if (sampleType) {
                    // For sample images, use the local sample data directly
                    analysisData = getSampleAnalysis(sampleType);
                } else {
                    // For uploaded images, send to backend for Ollama analysis
                    try {
                        const response = await fetch(`${BACKEND_URL}/analyze-image`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({ imageData: imageData }),
                        });

                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        analysisData = await response.json();
                    } catch (error) {
                        console.error('Error analyzing image with backend:', error);
                        // Fallback to a generic error message or 'unknown' sample
                        analysisData = getSampleAnalysis('unknown'); 
                        alert('Failed to analyze image. Please ensure your Ollama backend server is running and the model is installed.');
                    }
                }
                
                displayResults(analysisData);
                
                // Animate results cards
                setTimeout(() => {
                    const resultCards = document.querySelectorAll('.result-card');
                    resultCards.forEach((card, index) => {
                        setTimeout(() => {
                            card.classList.add('visible');
                        }, 200 * index);
                    });
                    
                    // Animate material cards
                    setTimeout(() => {
                        const materialCards = document.querySelectorAll('.material-card');
                        materialCards.forEach((card, index) => {
                            setTimeout(() => {
                                card.classList.add('visible');
                            }, 100 * index);
                        });
                    }, 600);
                }, 100);
            }
            
            function displayResults(data) {
                document.getElementById('product-name').textContent = data.productName;
                document.getElementById('material-composition').textContent = data.primaryMaterial;
                document.getElementById('biodegradability').textContent = data.biodegradability;
                
                // Set material breakdown
                const materialBreakdown = document.getElementById('material-breakdown');
                materialBreakdown.innerHTML = '';
                
                const breakdownDiv = document.createElement('div');
                breakdownDiv.className = 'flex flex-wrap gap-2';
                
                data.materials.forEach(material => {
                    const badge = document.createElement('span');
                    badge.className = 'material-card bg-opacity-20 px-3 py-1 rounded-full text-sm font-medium';
                    
                    if (material.percentage > 70) {
                        badge.classList.add('bg-blue-500', 'text-blue-800');
                    } else if (material.percentage > 30) {
                        badge.classList.add('bg-purple-500', 'text-purple-800');
                    } else {
                        badge.classList.add('bg-gray-500', 'text-gray-800');
                    }
                    
                    badge.textContent = `${material.name} (${material.percentage}%)`;
                    breakdownDiv.appendChild(badge);
                });
                
                materialBreakdown.appendChild(breakdownDiv);
                
                // Set materials analysis
                document.getElementById('materials-analysis').innerHTML = `
                    <p class="mb-3">${data.materialsAnalysis}</p>
                    <ul class="list-disc pl-5 space-y-1">
                        ${data.materialProperties.map(prop => `<li>${prop}</li>`).join('')}
                    </ul>
                `;
                
                // Set environmental impact
                document.getElementById('environmental-impact').innerHTML = `
                    <p class="mb-3">${data.environmentalImpact}</p>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <div class="flex justify-between mb-2">
                            <span class="font-medium text-gray-700">Decomposition Time:</span>
                            <span class="font-medium">${data.decompositionTime}</span>
                        </div>
                        <div class="flex justify-between mb-2">
                            <span class="font-medium text-gray-700">Recyclability:</span>
                            <span class="font-medium">${data.recyclability}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="font-medium text-gray-700">Carbon Footprint:</span>
                            <span class="font-medium">${data.carbonFootprint}</span>
                        </div>
                    </div>
                `;
                
                // Set eco alternatives
                document.getElementById('eco-alternatives').innerHTML = `
                    <p class="mb-3">${data.ecoAlternatives}</p>
                `;
                
                const alternativesGrid = document.getElementById('alternatives-grid');
                alternativesGrid.innerHTML = '';
                
                data.suggestedAlternatives.forEach(alt => {
                    const altCard = document.createElement('div');
                    altCard.className = 'material-card bg-white border border-gray-100 rounded-lg overflow-hidden shadow-sm';
                    altCard.innerHTML = `
                        <div class="p-4">
                            <h4 class="font-semibold text-gray-800 mb-2">${alt.name}</h4>
                            <p class="text-sm text-gray-600 mb-3">${alt.description}</p>
                            <div class="flex justify-between items-center">
                                <span class="text-sm font-medium ${alt.biodegradable ? 'text-green-600' : 'text-blue-600'}">
                                    ${alt.biodegradable ? 'Biodegradable' : 'Recyclable'}
                                </span>
                                <span class="text-xs px-2 py-1 rounded-full ${alt.ecoRating > 7 ? 'bg-green-100 text-green-800' : alt.ecoRating > 4 ? 'bg-amber-100 text-amber-800' : 'bg-red-100 text-red-800'}">
                                    Eco Score: ${alt.ecoRating}/10
                                </span>
                            </div>
                        </div>
                    `;
                    alternativesGrid.appendChild(altCard);
                });
            }
            
            // --- getSampleAnalysis is now only used for sample image clicks and backend fallback ---
            function getSampleAnalysis(productType) {
                const samples = {
                    'plastic-bottle': {
                        productName: "Plastic Water Bottle",
                        primaryMaterial: "PET (Polyethylene Terephthalate)",
                        biodegradability: "Low (500+ years)",
                        materials: [
                            { name: "PET Plastic", percentage: 95 },
                            { name: "HDPE (Cap)", percentage: 4 },
                            { name: "PP (Label)", percentage: 1 }
                        ],
                        materialsAnalysis: "This product is primarily made from PET plastic, a petroleum-based material that is lightweight, transparent, and commonly used for single-use beverage containers. While PET is recyclable, its production has significant environmental impacts and improper disposal creates long-lasting pollution.",
                        materialProperties: [
                            "Non-biodegradable - takes centuries to decompose naturally",
                            "Lightweight but durable material",
                            "Excellent moisture barrier properties",
                            "Contains no BPA but may leach other chemicals when heated"
                        ],
                        environmentalImpact: "Plastic bottles are a major contributor to global pollution. Over 1 million plastic bottles are sold every minute worldwide, with less than 30% being recycled. Those that end up in landfills or oceans take hundreds of years to break down into microplastics that enter the food chain.",
                        decompositionTime: "450-500 years",
                        recyclability: "Technically recyclable (rate: ~29%)",
                        carbonFootprint: "1.5 kg CO2 per bottle (production only)",
                        ecoAlternatives: "Consider these sustainable alternatives that dramatically reduce environmental impact while maintaining functionality:",
                        suggestedAlternatives: [
                            {
                                name: "Stainless Steel Bottle",
                                description: "Reusable, durable, and keeps liquids hot/cold for hours. Lasts for years with proper care.",
                                biodegradable: false,
                                ecoRating: 9
                            },
                            {
                                name: "Glass Bottle with Silicone Sleeve",
                                description: "Chemically inert, easy to clean, and 100% recyclable. Silicone sleeve provides grip and protection.",
                                biodegradable: false,
                                ecoRating: 8
                            },
                            {
                                name: "Plant-based PLA Bottle",
                                description: "Made from renewable resources like corn starch. Industrial composting required for breakdown.",
                                biodegradable: true,
                                ecoRating: 7
                            },
                            {
                                name: "Aluminum Water Bottle",
                                description: "Infinitely recyclable with much higher recycling rates than plastic. Lightweight but durable.",
                                biodegradable: false,
                                ecoRating: 8
                            }
                        ]
                    },
                    'cardboard-box': {
                        productName: "Cardboard Box",
                        primaryMaterial: "Corrugated Fiberboard",
                        biodegradability: "High (2-3 months)",
                        materials: [
                            { name: "Kraft Paper", percentage: 72 },
                            { name: "Fluting", percentage: 25 },
                            { name: "Adhesives", percentage: 3 }
                        ],
                        materialsAnalysis: "Cardboard is primarily composed of cellulose fibers from wood pulp, making it highly biodegradable and recyclable. Properly processed cardboard can be recycled 5-7 times before fibers degrade.",
                        materialProperties: [
                            "Biodegradable and compostable in proper conditions",
                            "High compression strength for stacking",
                            "Natural insulation properties",
                            "Absorbs moisture which affects structural integrity"
                        ],
                        environmentalImpact: "Cardboard has a relatively low environmental impact compared to plastic packaging. It decomposes quickly in composting facilities but can release methane in landfills if not properly disposed of.",
                        decompositionTime: "2-3 months (composted)",
                        recyclability: "Highly recyclable (rate: ~80%)",
                        carbonFootprint: "0.2 kg CO2 per box",
                        ecoAlternatives: "While cardboard is already eco-friendly, consider these sustainable enhancements:",
                        suggestedAlternatives: [
                            {
                                name: "Recycled Content Cardboard",
                                description: "Contains 100% post-consumer recycled fibers, reducing virgin material use",
                                biodegradable: true,
                                ecoRating: 9
                            },
                            {
                                name: "Mushroom Packaging",
                                description: "Grown from mycelium, fully biodegradable in weeks",
                                biodegradable: true,
                                ecoRating: 10
                            },
                            {
                                name: "Pulp Molding",
                                description: "Made from waste paper or agricultural fibers, compostable",
                                biodegradable: true,
                                ecoRating: 8
                            }
                        ]
                    },
                    'metal-can': {
                        productName: "Aluminum Can",
                        primaryMaterial: "Aluminum",
                        biodegradability: "Non-biodegradable",
                        materials: [
                            { name: "Aluminum", percentage: 99 },
                            { name: "Liner", percentage: 1 }
                        ],
                        materialsAnalysis: "Aluminum cans are infinitely recyclable without quality loss. The production is energy-intensive but recycling aluminum saves 95% of the energy needed for primary production.",
                        materialProperties: [
                            "Excellent barrier against light/oxygen",
                            "Lightweight yet durable",
                            "Highly conductive for heating/cooling",
                            "Non-biodegradable but highly recyclable"
                        ],
                        environmentalImpact: "While mining bauxite has significant impacts, recycling aluminum has the highest rates of any material (nearly 70% in US). Improper disposal can last 200-500 years as landfill.",
                        decompositionTime: "200-500 years",
                        recyclability: "Highly recyclable (rate: ~69%)",
                        carbonFootprint: "0.3 kg CO2 per can (50% recycled content)",
                        ecoAlternatives: "More sustainable options for beverage containers:",
                        suggestedAlternatives: [
                            {
                                name: "Refillable Glass Bottles",
                                description: "Can be reused 25+ times before recycling",
                                biodegradable: false,
                                ecoRating: 8
                            },
                            {
                                name: "Plant-based Tetra Paks",
                                description: "75% renewable materials, recyclable",
                                biodegradable: false,
                                ecoRating: 7
                            },
                            {
                                name: "Beverages in Bulk",
                                description: "Eliminates single-use packaging entirely",
                                biodegradable: true,
                                ecoRating: 10
                            }
                        ]
                    },
                    'glass-jar': {
                        productName: "Glass Jar",
                        primaryMaterial: "Soda-Lime Glass",
                        biodegradability: "Non-biodegradable",
                        materials: [
                            { name: "Silica", percentage: 70 },
                            { name: "Soda Ash", percentage: 15 },
                            { name: "Limestone", percentage: 10 },
                            { name: "Other", percentage: 5 }
                        ],
                        materialsAnalysis: "Glass is inert and non-toxic, making it ideal for food storage. While not biodegradable, it's infinitely recyclable without quality loss when properly processed.",
                        materialProperties: [
                            "Does not absorb flavors or odors",
                            "100% impermeable to gases/liquids",
                            "Thermally stable for heating/freezing",
                            "Heavy compared to other packaging"
                        ],
                        environmentalImpact: "Glass manufacturing is energy-intensive, but recycled glass (cullet) melts at lower temperatures. Broken glass can persist for millions of years but doesn't leach chemicals.",
                        decompositionTime: "1 million+ years",
                        recyclability: "Fully recyclable (rate: ~33%)",
                        carbonFootprint: "0.8 kg CO2 per jar (50% recycled content)",
                        ecoAlternatives: "Consider these sustainable alternatives for food storage:",
                        suggestedAlternatives: [
                            {
                                name: "Refillable Glass",
                                description: "Designed for reuse before eventual recycling",
                                biodegradable: false,
                                ecoRating: 9
                            },
                            {
                                name: "Silicone Food Storage",
                                description: "Flexible, reusable, reduces breakage",
                                biodegradable: false,
                                ecoRating: 7
                            },
                            {
                                name: "Beeswax Wraps",
                                description: "Organic cotton infused with beeswax for storage",
                                biodegradable: true,
                                ecoRating: 8
                            }
                        ]
                    },
                    'paper-bag': {
                        productName: "Paper Bag",
                        primaryMaterial: "Paper (Cellulose Fibers)",
                        biodegradability: "High (2-6 weeks)",
                        materials: [
                            { name: "Recycled Paper Pulp", percentage: 80 },
                            { name: "Virgin Wood Pulp", percentage: 15 },
                            { name: "Adhesives", percentage: 5 }
                        ],
                        materialsAnalysis: "Paper bags are made from renewable wood resources and are highly biodegradable and recyclable. Their environmental impact is generally lower than plastic bags, especially if made from recycled content.",
                        materialProperties: [
                            "Biodegradable and compostable",
                            "Made from renewable resources",
                            "Can be recycled multiple times",
                            "Less durable than plastic, susceptible to moisture"
                        ],
                        environmentalImpact: "Paper bags decompose relatively quickly. While their production can be energy and water intensive, they contribute less to long-term pollution than plastic. Recycling is key to minimizing their footprint.",
                        decompositionTime: "2-6 weeks (composted)",
                        recyclability: "Highly recyclable (rate: ~70%)",
                        carbonFootprint: "0.1 kg CO2 per bag",
                        ecoAlternatives: "Even more sustainable options for carrying goods:",
                        suggestedAlternatives: [
                            {
                                name: "Reusable Canvas Bag",
                                description: "Extremely durable, washable, and can be used thousands of times.",
                                biodegradable: false,
                                ecoRating: 10
                            },
                            {
                                name: "Jute Bag",
                                description: "Made from natural plant fibers, strong, durable, and biodegradable.",
                                biodegradable: true,
                                ecoRating: 9
                            },
                            {
                                name: "Compostable Bioplastic Bag",
                                description: "Made from plant-based polymers, designed to break down in industrial compost facilities.",
                                biodegradable: true,
                                ecoRating: 7
                            }
                        ]
                    },
                    'plastic-bag': {
                        productName: "Plastic Shopping Bag",
                        primaryMaterial: "LDPE (Low-Density Polyethylene)",
                        biodegradability: "Very Low (100-1000 years)",
                        materials: [
                            { name: "LDPE Plastic", percentage: 99 },
                            { name: "Colorants", percentage: 1 }
                        ],
                        materialsAnalysis: "Plastic shopping bags are typically made from LDPE, a petroleum-derived plastic. They are lightweight and cheap to produce but are a significant source of environmental pollution due to their widespread use and slow degradation.",
                        materialProperties: [
                            "Non-biodegradable - persists for centuries",
                            "Lightweight and flexible",
                            "Can break down into microplastics",
                            "Difficult to recycle due to 'film' nature"
                        ],
                        environmentalImpact: "Plastic bags are notorious for littering landscapes, harming wildlife, and contributing to ocean pollution. They take hundreds of years to break down and often end up in landfills or as environmental waste.",
                        decompositionTime: "100-1000 years",
                        recyclability: "Limited (often not accepted in curbside recycling)",
                        carbonFootprint: "0.05 kg CO2 per bag",
                        ecoAlternatives: "Crucial to switch to reusable options:",
                        suggestedAlternatives: [
                            {
                                name: "Reusable Shopping Bag (Fabric)",
                                description: "Durable, washable, and can replace thousands of single-use plastic bags.",
                                biodegradable: false,
                                ecoRating: 10
                            },
                            {
                                name: "Mesh Produce Bags",
                                description: "Reusable bags for fruits and vegetables, eliminating small plastic bags.",
                                biodegradable: false,
                                ecoRating: 9
                            },
                            {
                                name: "Backpack/Personal Bag",
                                description: "Utilize existing bags to carry purchases, avoiding new packaging.",
                                biodegradable: false,
                                ecoRating: 9
                            }
                        ]
                    },
                    'organic-produce': {
                        productName: "Organic Produce (e.g., Apple)",
                        primaryMaterial: "Organic Matter (Plant Fibers, Water)",
                        biodegradability: "Very High (Days to Weeks)",
                        materials: [
                            { name: "Water", percentage: 85 },
                            { name: "Carbohydrates", percentage: 10 },
                            { name: "Fiber", percentage: 3 },
                            { name: "Vitamins/Minerals", percentage: 2 }
                        ],
                        materialsAnalysis: "Organic produce consists entirely of natural, biodegradable materials. When composted, it enriches soil and returns nutrients to the earth, completing a natural cycle.",
                        materialProperties: [
                            "100% biodegradable and compostable",
                            "Nutrient-rich for soil",
                            "Renewable resource",
                            "Perishable, requires proper storage"
                        ],
                        environmentalImpact: "The environmental impact of organic produce is primarily related to its cultivation (water, land use, transportation) rather than the product itself. Proper composting avoids landfill methane emissions.",
                        decompositionTime: "Days to weeks (composted)",
                        recyclability: "Compostable",
                        carbonFootprint: "Very low (varies by transport)",
                        ecoAlternatives: "Focus on reducing waste and supporting sustainable agriculture:",
                        suggestedAlternatives: [
                            {
                                name: "Composting Food Scraps",
                                description: "Turn food waste into valuable soil amendment, reducing landfill burden.",
                                biodegradable: true,
                                ecoRating: 10
                            },
                            {
                                name: "Local & Seasonal Produce",
                                description: "Reduces transportation emissions and supports local economies.",
                                biodegradable: true,
                                ecoRating: 9
                            },
                            {
                                name: "Grow Your Own Food",
                                description: "Eliminates packaging and transportation entirely, ultimate sustainability.",
                                biodegradable: true,
                                ecoRating: 10
                            }
                        ]
                    },
                    'unknown': { // Fallback for when Ollama can't identify or map
                        productName: "Unknown Product",
                        primaryMaterial: "Undetermined",
                        biodegradability: "Unknown",
                        materials: [{ name: "Mixed Materials", percentage: 100 }],
                        materialsAnalysis: "The material composition could not be determined. Please try uploading a clearer image or a different product.",
                        materialProperties: ["Cannot assess properties without identification."],
                        environmentalImpact: "Environmental impact is unknown. Proper disposal depends on material type.",
                        decompositionTime: "Unknown",
                        recyclability: "Unknown",
                        carbonFootprint: "Unknown",
                        ecoAlternatives: "Please try again with a different image. For general eco-friendly practices, consider reducing consumption and reusing items.",
                        suggestedAlternatives: []
                    }
                };
                
                return samples[productType];
            }
        });
    </script>

</body>
</html>